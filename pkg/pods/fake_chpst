#!/usr/bin/env ruby

require 'optparse'

options = {}
OptionParser.new do |opts|
  opts.on("-e", "--env ENV", "Pass environment vars") do |v|
    options[:env] = v
  end
  opts.on("-u", "--user USER", "A user that this process would act as... but this is fake so we ignore it") do |u|
    # no op
  end
end.parse!

if options[:env]
  Dir.new(options[:env]).each do |file|
    if file != "." && file != ".." && !File.directory?(file)
      begin
        ENV[file] = File.read(file)
      rescue
        # silence errors
      end
    end
  end
end
exec ARGV.join(" ")
